---
layout: post
title:  Почему Random Forest работает?
subtitle: И как он помогает разбираться в вине и грибах
date:   2020-05-30
image:  images/girl-forest.jpg
tags:   [ML-алгоритмы]
---

Вопрос про обоснование “неприлично высокого” качества ансамблей деревьев я часто слышала и задавала на собеседованиях начинающих дата сайнтистов. Это беспроигрышный вариант - если кандидат не знает ответа, он, как минимум, может поразмышлять, и тогда можно наблюдать движение его мыслей. Если они движутся в сторону снижения энтропии - можно присмотреться к кандидату поближе.

### Что за лес вообще?

Решающие деревья как ML-алгоритм используется в индустрии в тех случаях, когда нейронная сеть - это стрельба из огнемёта по воробьям. То есть, если задача простая, но при этом признаки данных не очень подходят для применения традиционных линейных моделей.

Decision Tree, или решающее дерево относится к *логическим алгоритмам* машинного обучения. Если вам нужно классифицировать табличные данные (то есть не картинки и не звук), обычно самое первое, что пробуют, - это деревья. Классический пример такой задачи - кредитный скоринг: по набору параметров человека нужно решить, выдать ему кредит или нет.  Табличные данные часто содержат разнородные категориальные признаки, с которыми деревья справляются лучше других алгоритмов. Кроме того, от Decision Tree легко можно добиться объяснений, почему оно решило не выдавать человеку кредит, от нейронки таких объяснений не дождешься.

![Photo by Andrew Ridley on Unsplash]({{site.baseurl}}/images/mushrooms.jpg)

Еще одна задача - классификация грибов на съедобные и ядовитые по [этим данным](https://www.kaggle.com/uciml/mushroom-classification). Там забавные признаки типа “форма и цвет шляпки”, “число колец”, “расположение пластинок”. Вот часть таблички с данными грибов:

| cap-shape | cap-surface | gill-size | odor | bruises | class |
| :-------- | :---------- | :-------- | :------ | :--- | :---- |
| convex    | smooth      | narrow    | pungent | true | poisonous |
| convex    | smooth      | broad     | almond  | true | edible |
| bell      | smooth      | broad     | anise   | true | edible |
| flat      | fibrous     | broad     | none    | false | edible |



![Случайный лес в Финляндии]({{site.baseurl}}/images/finnish-random-forest.jpg)
*Случайный лес в Финляндии*
